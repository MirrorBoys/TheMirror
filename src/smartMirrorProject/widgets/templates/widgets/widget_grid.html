{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
    <link rel="icon" type="image/x-icon" href="{% static 'images/mirror.gif' %}">
    <title>SmartMirror</title>
</head>

<body>
    <h1>Goedemorgen Persoon!</h1>
    <div class="grid" id="widget-grid">
        {% for widget in widgets %}
            <div class="widget" id="widget-{{ widget.id }}">
                <h2>{{ widget.title }}</h2>
                <p>{{ widget.content }}</p>
            </div>
        {% endfor %}
    </div>
    <script>
        function updateWidgets() {
            fetch('TheMirror/update-widgets/') // Fetch the updates from the server
                .then(response => response.json()) // Parse the JSON response
                .then(data => { // Update the widgets with the new data
                    data.widgets.forEach(widget => {
                        const widgetDiv = document.getElementById(`widget-${widget.id}`); // Find the widget by ID
                        widgetDiv.querySelector('p').innerText = widget.content; // Update the content
                    });
                })
                .catch(error => console.error('Error fetching updates:', error)); // Log any errors
        }

        setInterval(updateWidgets, 1000); // Update the widgets every second
    </script>
</body>

</html>